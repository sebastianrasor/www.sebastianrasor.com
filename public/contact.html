<!doctype html>

<!--
   - Copyright (c) 2023 Sebastian Riley Rasor <https://www.sebastianrasor.com/contact>
   -
   - Permission to use, copy, modify, and distribute this software for any
   - purpose with or without fee is hereby granted, provided that the above
   - copyright notice and this permission notice appear in all copies.
   -
   - THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   - WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   - MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   - ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   - WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   - ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   - OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
   -->

<html lang="en">
<meta charset="utf-8">
<meta name="description" content="Contact Sebastian Rasor">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://www.sebastianrasor.com/contact">
<title>Sebastian Rasor - Contact</title>
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
<script src="/openpgp.min.js"></script>
<script>
	const publicKeyArmored = [
		'-----BEGIN PGP PUBLIC KEY BLOCK-----',
		'',
		'xjMEYNEzohYJKwYBBAHaRw8BAQdAQyh7DUOy8DADNA1uozRJOt94FbpqOsQT',
		'lLI1usc8u8/NJ3NlYkBzdGlhbnJhc29yLmNvbSA8c2ViQHN0aWFucmFzb3Iu',
		'Y29tPsKPBBAWCgAgBQJg0TOiBgsJBwgDAgQVCAoCBBYCAQACGQECGwMCHgEA',
		'IQkQWiL3l5tgcqMWIQStp7jJvqtuQaqgI29aIveXm2Byo0GjAQDZrZQ5IgDM',
		'CNK8xT1fkf7ZGLYmsF+ldQMVB0bGyH2tfgEAg6r4DGjC35EN5cxrGH2fsgPQ',
		'8R8Zs6oQ5OERvn79tgjOOARg0TOiEgorBgEEAZdVAQUBAQdA5ScMDD5562SR',
		'/8dkKeVTidN+D9pFdM0h52nDvNzHbGcDAQgHwngEGBYIAAkFAmDRM6ICGwwA',
		'IQkQWiL3l5tgcqMWIQStp7jJvqtuQaqgI29aIveXm2ByowxVAPoDiD2As0yn',
		'BizyCHUQ1ZCq1bMR/XUrfu53Ly5cvIBhEwD/RoorwKn7vVqYPMk94c98P2Kv',
		'BYo5vdAiB7SZLKqG6AA=',
		'=QklC',
		'-----END PGP PUBLIC KEY BLOCK-----'
	].join('\n');

	window.enableSubmit = () => {
		document.getElementById("btnSubmit").disabled=false
	}

	window.disableSubmit = () => {
		document.getElementById("btnSubmit").disabled=true
	}
	window.onbeforeunload = disableSubmit;

	window.onSubmit = async (evt) => {
		evt.preventDefault();
		if (document.getElementById("btnSubmit").disabled) {
			return false;
		} else {
			const form = evt.target;
			form.name.readOnly = true;
			form.email.readOnly = true;
			form.message.readOnly = true;
			try {
				await openpgp.readMessage({ armoredMessage: form.message.value });
				form.submit();
				return true;
			} catch(err) {
				// noop
			}
			const publicKey = await openpgp.readKey({ armoredKey: publicKeyArmored });
			const encrypted = await openpgp.encrypt({
				message: await openpgp.createMessage({ text: form.message.value }),
				encryptionKeys: publicKey,
			});
			form.message.value = encrypted;
			form.submit();
		}
	}
</script>
<style>
	:root {
		--color: black;
		--background-color: white;
	}
	@media (prefers-color-scheme: dark) {
		:root {
			--color: white;
			--background-color: black;
		}
	}
	html {
		color: var(--color);
		background-color: var(--background-color);
	}
	html, body {
		margin: 0 auto;
		height: 100%;
	}
	body, form {
		align-items: center;
		display: flex;
		flex-direction: column;
		gap: 1.5em;
		justify-content: center;
	}
	input, textarea {
		all: unset;
	}
	textarea {
		overflow-wrap: break-word;
	}
	input, textarea {
		border-bottom: 1px var(--color) solid;
	}
	input[type=submit]:disabled,
	input[type=submit][disabled] {
		background: var(--background-color);
		border: 1px var(--color) solid;
		color: gray;
		cursor: not-allowed;
	}
	input[type=submit] {
		background: var(--color);
		color: var(--background-color);
		cursor: pointer;
		padding: 2px 4px;
	}
	.input-container {
		display: grid;
		justify-contant: start;
		padding: 0;
	}
	.input-container * {
		grid-area: 1 / 1 / 2 / 2;
		width: 100%;
	}
	input + label, textarea + label {
		cursor: text;
		user-select: none;
		color: gray;
		transition: 0.25s;
		transform-origin: bottom left;
	}
	input:focus + label,
	input:not(:placeholder-shown) + label,
	textarea:focus + label,
	textarea:not(:placeholder-shown) + label {
		color: var(--color);
		cursor: default;
		pointer-events: none;
		transform: scale(75%) translate(0, 100%);
		transition: 0.25s;
		user-select: none;
	}
</style>
<form method="POST" action="/contact" onSubmit="onSubmit(event)">
	<noscript><p>This form requires JavaScript to function.</noscript>
	<div class="input-container">
		<input type="text" id="name" name="name" placeholder=" " size="40" required>
		<label for="name">Your Name</label>
	</div>
	<div class="cf-turnstile" data-sitekey="0x4AAAAAAACsmQqydNII05ly" data-callback="enableSubmit" data-error-callback="disableSubmit" data-timeout-callback="disableSubmit" data-expired-callback="disableSubmit"></div>
	<div class="input-container">
		<input type="email" id="email" name="email" placeholder=" " size="40" required>
		<label for="email">your@email.address</label>
	</div>
	<div class="input-container">
		<textarea id="message" name="message" placeholder=" " rows="4" cols="40" required></textarea>
		<label for="message">Your Message</label>
	</div>
	<input type="submit" id="btnSubmit" name="btnSubmit" value="Submit" disabled>
</form>
